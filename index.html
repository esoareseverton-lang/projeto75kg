<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sua evolu√ß√£o come√ßa aqui</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #05060b;
      --card: #111521;
      --accent: #4cc9f0;
      --accent2: #f72585;
      --text: #f5f5f5;
      --muted: #8a8fa3;
      --border: #222533;
    }
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      background: radial-gradient(circle at top, #151b2e, #05060b 55%, #020308 100%);
      color: var(--text);
      min-height: 100vh;
    }
    .shell {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px 12px 40px;
    }
    .card {
      background: radial-gradient(circle at top left, #1b2034, #090b12 55%);
      border-radius: 18px;
      padding: 18px 16px;
      border: 1px solid var(--border);
      box-shadow: 0 18px 55px rgba(0,0,0,0.7);
      margin-bottom: 18px;
    }
    h1, h2, h3 {
      margin: 0 0 8px;
    }
    h1 {
      font-size: 1.9rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }
    h2 {
      font-size: 1.12rem;
    }
    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }
    .badge {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(0,0,0,0.4);
    }
    .badge-accent {
      border-color: var(--accent);
      color: var(--accent);
    }
    .meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--muted);
    }
    .meta-label {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 0.7rem;
      color: #6b7086;
    }
    .highlight {
      font-weight: 600;
      color: var(--accent);
    }
    .grid {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1.1fr);
      gap: 16px;
    }
    @media (max-width: 880px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    label {
      display: block;
      font-size: 0.8rem;
      margin-bottom: 4px;
      color: var(--muted);
    }
    input, select {
      width: 100%;
      padding: 10px 11px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #070910;
      color: var(--text);
      font-size: 0.9rem;
      outline: none;
    }
    input:focus, select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(76,201,240,0.3);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 720px) {
      .form-grid {
        grid-template-columns: repeat(2, minmax(0,1fr));
      }
    }
    @media (max-width: 480px) {
      .form-grid {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .form-grid-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 600px) {
      .form-grid-2 {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 12px;
    }
    button {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.85rem;
      padding: 11px 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-weight: 500;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent), #4895ef);
      color: #020308;
      box-shadow: 0 12px 30px rgba(72,149,239,0.45);
      flex: 1;
    }
    .btn-ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      min-width: 140px;
    }
    @media (max-width: 600px) {
      .btn-row {
        flex-direction: column;
      }
      .btn-primary, .btn-ghost {
        width: 100%;
      }
    }

    .table-wrap {
      overflow-x: auto;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #05060b;
      -webkit-overflow-scrolling: touch;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      min-width: 620px;
    }
    thead {
      background: linear-gradient(90deg, #101320, #15192a);
    }
    th, td {
      padding: 8px 10px;
      text-align: left;
      white-space: nowrap;
    }
    th {
      font-weight: 600;
      font-size: 0.75rem;
      color: #c4c7de;
      border-bottom: 1px solid var(--border);
    }
    tbody tr:nth-child(even) {
      background: rgba(255,255,255,0.015);
    }
    tbody tr:hover {
      background: rgba(76,201,240,0.06);
    }
    .pill {
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      font-size: 0.7rem;
      color: var(--muted);
    }
    canvas {
      width: 100% !important;
      height: 260px !important;
    }
    .small {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 6px;
    }
    .tagline {
      margin-top: 8px;
      font-size: 0.95rem;
      color: var(--muted);
    }
    .motivacao {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 12px;
      background: linear-gradient(120deg, rgba(76,201,240,0.12), rgba(247,37,133,0.08));
      border: 1px solid rgba(76,201,240,0.3);
      font-size: 0.85rem;
    }
    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }
    .pill-tag {
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,0.01);
    }
    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    @media (max-width: 480px) {
      h1 {
        font-size: 1.5rem;
      }
      .shell {
        padding: 16px 10px 32px;
      }
      .card {
        padding: 16px 12px;
        border-radius: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="shell">

    <!-- HEADER -->
    <div class="card">
      <h1>Sua evolu√ß√£o come√ßa aqui</h1>
      <p class="tagline">
        Painel de acompanhamento de peso, medidas e sensa√ß√£o di√°ria.
        Serve para qualquer objetivo: perder gordura, ganhar massa, recomposi√ß√£o‚Ä¶ o dono √© voc√™.
      </p>
      <div class="badge-row">
        <span class="badge badge-accent">Modo: Dark premium</span>
        <span class="badge">Dom√≠nio: esoares.net.br</span>
        <span class="badge">Cada pessoa com seus dados separados (vers√£o local)</span>
      </div>
      <div class="meta-row">
        <div>
          <div class="meta-label">Resumo do objetivo</div>
          <div id="resumoObjetivo">Defina abaixo seu objetivo, peso e medidas iniciais.</div>
        </div>
      </div>
      <div id="motivacaoBox" class="motivacao">
        Primeiro passo √© abrir a p√°gina. Parab√©ns, voc√™ j√° fez a parte que 90% das pessoas n√£o faz. Agora √© registrar a Semana 1. üòâ
      </div>
    </div>

    <!-- CONFIGURA√á√ïES DO USU√ÅRIO -->
    <div class="card">
      <h2>Configura√ß√µes do seu perfil</h2>
      <p class="small">
        Esses dados s√£o usados para calcular progresso, metas e mensagens motivacionais.
        Tudo fica salvo <strong>somente neste dispositivo</strong> (depois a gente leva pra nuvem via Firebase).
      </p>

      <div class="form-grid-2" style="margin-top:10px;">
        <div>
          <label for="nomeUsuario">Nome</label>
          <input type="text" id="nomeUsuario" placeholder="Ex: √âverton" />
        </div>
        <div>
          <label for="perfilUsuario">Perfil</label>
          <select id="perfilUsuario">
            <option value="">Selecione...</option>
            <option value="masc">Masculino</option>
            <option value="fem">Feminino</option>
            <option value="outro">Outro / prefiro n√£o dizer</option>
          </select>
        </div>
      </div>

      <div style="margin-top:10px;">
        <label for="objetivoPrincipal">Objetivo principal</label>
        <input type="text" id="objetivoPrincipal" placeholder="Ex: perder 8 kg mantendo massa magra" />
      </div>

      <div class="form-grid" style="margin-top:10px;">
        <div>
          <label for="pesoInicial">Peso inicial (kg)</label>
          <input type="number" step="0.1" id="pesoInicial" placeholder="Ex: 89.5" />
        </div>
        <div>
          <label for="pesoMeta">Peso meta (kg)</label>
          <input type="number" step="0.1" id="pesoMeta" placeholder="Ex: 80.0" />
        </div>
        <div>
          <label for="cinturaInicial">Cintura inicial (cm)</label>
          <input type="number" step="0.1" id="cinturaInicial" placeholder="Ex: 96" />
        </div>
        <div>
          <label for="cinturaMeta">Cintura meta (cm)</label>
          <input type="number" step="0.1" id="cinturaMeta" placeholder="Ex: 86" />
        </div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" id="saveSettingsBtn">Salvar configura√ß√µes</button>
        <button class="btn-ghost" id="clearSettingsBtn">Limpar perfil (local)</button>
      </div>
      <p class="small">
        Dica: voc√™ pode usar perfis diferentes em dispositivos diferentes (ex: voc√™ no notebook, outra pessoa no celular).
      </p>
    </div>

    <!-- GRID: FORM + GR√ÅFICO -->
    <div class="grid">
      <!-- FORM -->
      <div class="card">
        <h2>Registrar semana</h2>
        <p class="small">
          Preencha os dados da semana e clique em <strong>Adicionar</strong>.
          O gr√°fico e a tabela s√£o atualizados automaticamente neste navegador.
        </p>
        <div style="margin-top:10px;">
          <label for="week">Semana</label>
          <select id="week">
            <option value="">Selecione...</option>
            <option value="1">Semana 1</option>
            <option value="2">Semana 2</option>
            <option value="3">Semana 3</option>
            <option value="4">Semana 4</option>
            <option value="5">Semana 5</option>
            <option value="6">Semana 6</option>
            <option value="7">Semana 7</option>
            <option value="8">Semana 8</option>
            <option value="9">Semana 9</option>
            <option value="10">Semana 10</option>
            <option value="11">Semana 11</option>
            <option value="12">Semana 12</option>
          </select>
        </div>

        <div class="form-grid" style="margin-top:10px;">
          <div>
            <label for="peso">Peso da semana (kg)</label>
            <input type="number" step="0.1" id="peso" placeholder="Ex: 87.0" />
          </div>
          <div>
            <label for="cintura">Cintura (cm)</label>
            <input type="number" step="0.1" id="cintura" placeholder="Ex: 90" />
          </div>
          <div>
            <label for="energia">Energia (1‚Äì10)</label>
            <input type="number" min="1" max="10" id="energia" placeholder="Ex: 8" />
          </div>
          <div>
            <label for="humor">Humor (1‚Äì10)</label>
            <input type="number" min="1" max="10" id="humor" placeholder="Ex: 9" />
          </div>
          <div>
            <label for="sono">Sono (1‚Äì10)</label>
            <input type="number" min="1" max="10" id="sono" placeholder="Ex: 7" />
          </div>
        </div>

        <div style="margin-top:10px;">
          <label for="obs">Observa√ß√µes</label>
          <input type="text" id="obs" placeholder="Ex: mais cardio, menos fome, viagem, TPM, etc." />
        </div>

        <div class="btn-row">
          <button class="btn-primary" id="addBtn">Ôºã Adicionar semana</button>
          <button class="btn-ghost" id="resetBtn">Limpar hist√≥rico (local)</button>
        </div>

        <p class="small">
          Os dados ficam salvos apenas neste dispositivo (localStorage do navegador).
          Quando conectarmos ao Firebase, cada login ter√° seus dados em nuvem.
        </p>
      </div>

      <!-- GR√ÅFICO -->
      <div class="card" style="position:relative; min-height:320px;">
        <h2>Gr√°fico de Progresso</h2>
        <p class="small">
          Linha azul = Peso (kg) ‚Ä¢ Linha rosa = Cintura (cm). 
          O que importa √© a <strong>tend√™ncia</strong>, n√£o um dia isolado.
        </p>
        <div style="position:absolute; inset:72px 8px 8px 8px;">
          <canvas id="progressChart"></canvas>
        </div>
      </div>
    </div>

    <!-- TABELA -->
    <div class="card">
      <h2>Hist√≥rico completo</h2>
      <p class="small">
        Di√°rio de progresso. No celular, arraste pro lado pra ver todas as colunas.
      </p>
      <div class="table-wrap">
        <table id="historyTable">
          <thead>
            <tr>
              <th>Semana</th>
              <th>Peso (kg)</th>
              <th>Cintura (cm)</th>
              <th>Energia</th>
              <th>Humor</th>
              <th>Sono</th>
              <th>Observa√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- TREINOS POR FASE -->
    <div class="card">
      <h2>Treinos recomendados por fase</h2>
      <p class="small">
        Estrutura pensada para caber em perfis masculinos e femininos. 
        Todo mundo pode fazer tudo ‚Äî as diferen√ßas s√£o s√≥ de foco.
      </p>

      <h3>Fase 1 ‚Äì Semanas 1‚Äì4 (Adapta√ß√£o)</h3>
      <p class="small">
        Foco: t√©cnica, costume de treino e n√£o morrer no cardio üòÖ
      </p>
      <ul class="small">
        <li><strong>3‚Äì4 treinos de muscula√ß√£o/semana</strong> (full-body leve ou divis√£o simples)</li>
        <li><strong>Cardio leve</strong>: caminhadas de 15‚Äì20 min, 3‚Äì4x/semana</li>
      </ul>

      <h3>Fase 2 ‚Äì Semanas 5‚Äì8 (Consolida√ß√£o)</h3>
      <p class="small">
        Foco: progress√£o de carga e consist√™ncia.
      </p>
      <ul class="small">
        <li><strong>4 treinos de muscula√ß√£o/semana</strong> 
          (peito+tr√≠ceps / costas+b√≠ceps / pernas / ombro+core)
        </li>
        <li>Cardio leve 20‚Äì30 min, 3‚Äì5x/semana</li>
      </ul>

      <h3>Fase 3 ‚Äì Semanas 9‚Äì12 (Performance)</h3>
      <p class="small">
        Foco: performance e defini√ß√£o, sem loucura.
      </p>
      <ul class="small">
        <li><strong>4‚Äì5 treinos de muscula√ß√£o/semana</strong></li>
        <li>Cardio leve quase di√°rio (20‚Äì30 min)</li>
      </ul>

      <p class="small">
        <strong>Sugest√£o extra ‚Äì foco masculino</strong>: mais √™nfase em peito, costas e ombros. 
        <strong>Sugest√£o extra ‚Äì foco feminino</strong>: mais √™nfase em gl√∫teos, posterior de coxa e core. 
        Mas, de novo: todo mundo pode treinar tudo. üí™
      </p>

      <p class="small">
        V√≠deos de execu√ß√£o (links abrem busca no YouTube):
      </p>
      <ul class="small">
        <li><a target="_blank" href="https://www.youtube.com/results?search_query=supino+reto+execu%C3%A7%C3%A3o+correta">Supino reto</a></li>
        <li><a target="_blank" href="https://www.youtube.com/results?search_query=agachamento+livre+execu%C3%A7%C3%A3o+correta">Agachamento</a></li>
        <li><a target="_blank" href="https://www.youtube.com/results?search_query=levantamento+terra+romaniano+execu%C3%A7%C3%A3o+correta">Levantamento terra (romaniano)</a></li>
        <li><a target="_blank" href="https://www.youtube.com/results?search_query=remada+curvada+execu%C3%A7%C3%A3o+correta">Remada</a></li>
        <li><a target="_blank" href="https://www.youtube.com/results?search_query=prancha+abdominal+execu%C3%A7%C3%A3o+correta">Prancha abdominal</a></li>
      </ul>
    </div>

    <!-- SUPLEMENTOS / VITAMINAS -->
    <div class="card">
      <h2>Vitam√≠nicos & suplementa√ß√£o (organiza√ß√£o)</h2>
      <p class="small">
        Sempre siga a orienta√ß√£o do seu m√©dico. Abaixo √© s√≥ um jeito organizado de visualizar o protocolo.
      </p>

      <h3>Manh√£</h3>
      <ul class="small">
        <li>Whey / prote√≠na ‚Äì ao acordar ou p√≥s-treino</li>
        <li>Creatina (3‚Äì5 g) ‚Äì junto com alguma refei√ß√£o</li>
        <li>Vitamina C</li>
        <li>Manipulados di√°rios prescritos</li>
        <li>C√°lcio + magn√©sio + pot√°ssio, se indicados</li>
      </ul>

      <div class="pill-row">
        <span class="pill-tag">M√∫sculo: prote√≠na + creatina</span>
        <span class="pill-tag">Hormonal: manipulado</span>
        <span class="pill-tag">Equil√≠brio: eletr√≥litos</span>
      </div>

      <h3>Noite</h3>
      <ul class="small">
        <li>Vitamina D ‚Äì com refei√ß√£o com gordura (ex: jantar)</li>
        <li>Foco em sono consistente e boa hidrata√ß√£o</li>
      </ul>

      <h3>Semanal</h3>
      <ul class="small">
        <li>Medica√ß√µes injet√°veis (ex: Monjaro) sempre conforme prescri√ß√£o.</li>
      </ul>

      <p class="small">
        Qualquer sintoma estranho (tontura, fadiga bizarra, etc.) entra nas observa√ß√µes da semana
        e vai pra conversa com o m√©dico. Combina√ß√£o perfeita: ci√™ncia + dados + bom humor. üòÑ
      </p>
    </div>

  </div>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // --- Keys de storage local ---
    const SETTINGS_KEY = "evolucao_settings_v1";
    const PROGRESS_KEY = "evolucao_progresso_v1";

    function loadJSON(key, fallback) {
      const raw = localStorage.getItem(key);
      if (!raw) return fallback;
      try { return JSON.parse(raw); } catch (e) {
        console.error("Erro ao ler localStorage", key, e);
        return fallback;
      }
    }

    function saveJSON(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }

    let userSettings = loadJSON(SETTINGS_KEY, null);
    let progressData = loadJSON(PROGRESS_KEY, []);

    // --- ELEMENTOS ---
    const tableBody = document.querySelector("#historyTable tbody");
    const motivacaoBox = document.getElementById("motivacaoBox");
    const resumoObjetivoEl = document.getElementById("resumoObjetivo");

    const nomeUsuarioEl = document.getElementById("nomeUsuario");
    const perfilUsuarioEl = document.getElementById("perfilUsuario");
    const objetivoPrincipalEl = document.getElementById("objetivoPrincipal");
    const pesoInicialEl = document.getElementById("pesoInicial");
    const pesoMetaEl = document.getElementById("pesoMeta");
    const cinturaInicialEl = document.getElementById("cinturaInicial");
    const cinturaMetaEl = document.getElementById("cinturaMeta");

    // --- Aplicar configura√ß√µes na tela ---
    function aplicarSettingsNaTela() {
      if (!userSettings) return;
      nomeUsuarioEl.value = userSettings.nome ?? "";
      perfilUsuarioEl.value = userSettings.perfil ?? "";
      objetivoPrincipalEl.value = userSettings.objetivo ?? "";
      pesoInicialEl.value = userSettings.pesoInicial ?? "";
      pesoMetaEl.value = userSettings.pesoMeta ?? "";
      cinturaInicialEl.value = userSettings.cinturaInicial ?? "";
      cinturaMetaEl.value = userSettings.cinturaMeta ?? "";
    }

    function atualizarResumoObjetivo() {
      if (!userSettings) {
        resumoObjetivoEl.textContent = "Defina abaixo seu objetivo, peso e medidas iniciais.";
        return;
      }
      const partes = [];
      if (userSettings.objetivo) partes.push(userSettings.objetivo);

      if (userSettings.pesoInicial && userSettings.pesoMeta) {
        partes.push(\`peso: \${userSettings.pesoInicial} ‚Üí \${userSettings.pesoMeta} kg\`);
      }
      if (userSettings.cinturaInicial && userSettings.cinturaMeta) {
        partes.push(\`cintura: \${userSettings.cinturaInicial} ‚Üí \${userSettings.cinturaMeta} cm\`);
      }
      if (!partes.length) {
        resumoObjetivoEl.textContent = "Complete as metas de peso e cintura para um resumo mais bonitinho aqui.";
      } else {
        resumoObjetivoEl.textContent = partes.join(" ‚Ä¢ ");
      }
    }

    // --- Tabela ---
    function renderTable() {
      tableBody.innerHTML = "";
      const sorted = [...progressData].sort((a, b) => a.week - b.week);
      for (const row of sorted) {
        const tr = document.createElement("tr");
        tr.innerHTML = \`
          <td><span class="pill">Semana \${row.week}</span></td>
          <td>\${row.peso ?? ""}</td>
          <td>\${row.cintura ?? ""}</td>
          <td>\${row.energia ?? ""}</td>
          <td>\${row.humor ?? ""}</td>
          <td>\${row.sono ?? ""}</td>
          <td>\${row.obs ?? ""}</td>
        \`;
        tableBody.appendChild(tr);
      }
    }

    // --- Gr√°fico ---
    const ctx = document.getElementById("progressChart").getContext("2d");
    let chart;

    function renderChart() {
      const sorted = [...progressData].sort((a, b) => a.week - b.week);
      const labels = sorted.map(d => "S" + d.week);
      const pesos = sorted.map(d => d.peso);
      const cinturas = sorted.map(d => d.cintura);

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [
            {
              label: "Peso (kg)",
              data: pesos,
              borderColor: "#4cc9f0",
              backgroundColor: "rgba(76,201,240,0.1)",
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 3
            },
            {
              label: "Cintura (cm)",
              data: cinturas,
              borderColor: "#f72585",
              backgroundColor: "rgba(247,37,133,0.1)",
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: { color: "#d0d3ea", usePointStyle: true }
            }
          },
          scales: {
            x: {
              ticks: { color: "#9ba0c2" },
              grid: { color: "rgba(255,255,255,0.03)" }
            },
            y: {
              ticks: { color: "#9ba0c2" },
              grid: { color: "rgba(255,255,255,0.03)" }
            }
          }
        }
      });
    }

    // --- Progresso percentual baseado em peso ---
    function calcularProgressoPercentual() {
      if (!userSettings || !userSettings.pesoInicial || !userSettings.pesoMeta) return null;
      if (!progressData.length) return null;

      const sorted = [...progressData].sort((a, b) => a.week - b.week);
      const last = sorted[sorted.length - 1];
      if (!last.peso) return null;

      const pesoInicial = Number(userSettings.pesoInicial);
      const pesoMeta = Number(userSettings.pesoMeta);
      const pesoAtual = Number(last.peso);

      const total = pesoInicial - pesoMeta;
      if (total === 0) return null;

      const feito = pesoInicial - pesoAtual;
      return (feito / total) * 100;
    }

    function atualizarMotivacao() {
      if (!progressData.length) {
        motivacaoBox.textContent =
          "Primeiro registro ainda n√£o feito. Quando voc√™ salvar a Semana 1, eu j√° preparo um discurso motivacional digno de final de campeonato.";
        return;
      }

      const sorted = [...progressData].sort((a, b) => a.week - b.week);
      const last = sorted[sorted.length - 1];
      const percent = calcularProgressoPercentual();
      let msg;

      const temMetaPeso = userSettings && userSettings.pesoMeta && userSettings.pesoInicial;

      if (temMetaPeso && last.peso && Number(last.peso) <= Number(userSettings.pesoMeta)) {
        msg = "ALERTA DE CONQUISTA! A meta de peso foi atingida. Agora √© s√≥ manter a consist√™ncia e escolher qual foto vai ser a de antes e depois. üî•";
      } else if (percent === null) {
        msg = "Progresso registrado! Quando voc√™ preencher peso inicial e meta, eu come√ßo a fazer contas e a te lembrar o quanto voc√™ j√° andou.";
      } else if (percent < 0) {
        msg = "A balan√ßa subiu um pouco? Relaxa. Pode ser hor√°rio, reten√ß√£o, fase da lua‚Ä¶ O importante √© n√£o transformar um dia fora da rota em uma semana inteira.";
      } else if (percent < 20) {
        msg = \`Come√ßo honesto: ~\${percent.toFixed(1)}% do caminho. Todo her√≥i come√ßa no n√≠vel 1. O segredo √© n√£o desinstalar o jogo.\`;
      } else if (percent < 50) {
        msg = \`Boa! Voc√™ j√° fez cerca de \${percent.toFixed(1)}% do caminho. N√£o √© sprint, √© maratona ‚Äî mas a medalha j√° t√° te esperando.\`;
      } else if (percent < 80) {
        msg = \`Mais da metade conclu√≠da (\${percent.toFixed(1)}%). Se desistir agora, o ‚Äúvoc√™ do futuro‚Äù vai ficar bem chateado. E ele √© exigente.\`;
      } else {
        msg = \`Voc√™ j√° passou dos \${percent.toFixed(1)}% do caminho. √â praticamente cr√©ditos finais do filme ‚Äî s√≥ falta fechar com chave de ouro.\`;
      }

      motivacaoBox.textContent = msg;
    }

    // --- Eventos: salvar configura√ß√µes ---
    document.getElementById("saveSettingsBtn").addEventListener("click", () => {
      const pesoInicial = pesoInicialEl.value ? Number(pesoInicialEl.value.replace(",", ".")) : null;
      const pesoMeta = pesoMetaEl.value ? Number(pesoMetaEl.value.replace(",", ".")) : null;
      const cinturaInicial = cinturaInicialEl.value ? Number(cinturaInicialEl.value.replace(",", ".")) : null;
      const cinturaMeta = cinturaMetaEl.value ? Number(cinturaMetaEl.value.replace(",", ".")) : null;

      userSettings = {
        nome: nomeUsuarioEl.value.trim() || null,
        perfil: perfilUsuarioEl.value || null,
        objetivo: objetivoPrincipalEl.value.trim() || null,
        pesoInicial,
        pesoMeta,
        cinturaInicial,
        cinturaMeta
      };

      saveJSON(SETTINGS_KEY, userSettings);
      atualizarResumoObjetivo();
      atualizarMotivacao();
      alert("Configura√ß√µes salvas neste dispositivo.");
    });

    document.getElementById("clearSettingsBtn").addEventListener("click", () => {
      if (!confirm("Tem certeza que deseja limpar os dados de perfil deste dispositivo?")) return;
      userSettings = null;
      saveJSON(SETTINGS_KEY, userSettings);
      nomeUsuarioEl.value = "";
      perfilUsuarioEl.value = "";
      objetivoPrincipalEl.value = "";
      pesoInicialEl.value = "";
      pesoMetaEl.value = "";
      cinturaInicialEl.value = "";
      cinturaMetaEl.value = "";
      atualizarResumoObjetivo();
      atualizarMotivacao();
    });

    // --- Eventos: semanas ---
    document.getElementById("addBtn").addEventListener("click", () => {
      const week = parseInt(document.getElementById("week").value, 10);
      const pesoVal = document.getElementById("peso").value.replace(",", ".");
      const cinturaVal = document.getElementById("cintura").value.replace(",", ".");
      const peso = parseFloat(pesoVal);
      const cintura = cinturaVal.trim() !== "" ? parseFloat(cinturaVal) : null;
      const energiaVal = document.getElementById("energia").value;
      const humorVal = document.getElementById("humor").value;
      const sonoVal = document.getElementById("sono").value;
      const energia = energiaVal ? parseInt(energiaVal, 10) : null;
      const humor = humorVal ? parseInt(humorVal, 10) : null;
      const sono = sonoVal ? parseInt(sonoVal, 10) : null;
      const obs = document.getElementById("obs").value.trim();

      if (!week || isNaN(week)) {
        alert("Selecione a semana.");
        return;
      }
      if (isNaN(peso)) {
        alert("Informe o peso (kg).");
        return;
      }

      const entry = { week, peso, cintura, energia, humor, sono, obs };

      const existingIndex = progressData.findIndex(d => d.week === week);
      if (existingIndex >= 0) {
        progressData[existingIndex] = entry;
      } else {
        progressData.push(entry);
      }

      saveJSON(PROGRESS_KEY, progressData);
      renderTable();
      renderChart();
      atualizarMotivacao();
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      if (!confirm("Tem certeza que deseja apagar todos os registros deste dispositivo?")) return;
      progressData = [];
      saveJSON(PROGRESS_KEY, progressData);
      renderTable();
      renderChart();
      atualizarMotivacao();
    });

    // --- Inicializar ---
    aplicarSettingsNaTela();
    atualizarResumoObjetivo();
    renderTable();
    renderChart();
    atualizarMotivacao();
  </script>
</body>
</html>
