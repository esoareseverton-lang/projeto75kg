<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sua evolu√ß√£o come√ßa aqui ‚Äì Dark Premium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonte b√°sica do sistema para ficar leve -->
  <style>
    :root {
      --bg: #05060a;
      --card: #111525;
      --card-soft: #14192b;
      --accent: #4cc9f0;
      --accent-soft: rgba(76,201,240,0.16);
      --accent2: #f72585;
      --accent2-soft: rgba(247,37,133,0.16);
      --text: #f5f5f5;
      --muted: #9ba0c2;
      --border: #262a3d;
      --danger: #ff6b6b;
      --success: #51cf66;
    }
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      background: radial-gradient(circle at top, #151a30, #02030a);
      color: var(--text);
      min-height: 100vh;
    }
    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .app-shell {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px 12px 40px;
    }
    .brand-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }
    .brand-title {
      font-size: 1.6rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }
    .brand-sub {
      font-size: 0.8rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.2em;
    }
    .chip {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(0,0,0,0.3);
      white-space: nowrap;
    }
    .chip-accent {
      border-color: var(--accent);
      color: var(--accent);
    }

    .card {
      background: linear-gradient(140deg, #101426, #070814);
      border-radius: 18px;
      padding: 18px 16px;
      border: 1px solid var(--border);
      box-shadow: 0 18px 45px rgba(0,0,0,0.75);
      margin-bottom: 18px;
    }
    .card-soft {
      background: linear-gradient(145deg, #151a31, #090b16);
    }
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }
    h1,h2,h3 {
      margin: 0 0 6px;
    }
    h2 {
      font-size: 1.05rem;
    }
    h3 {
      font-size: 0.95rem;
    }
    .muted {
      color: var(--muted);
      font-size: 0.8rem;
    }

    /* Layout principal */
    .layout-main {
      display: grid;
      grid-template-columns: minmax(0, 1.35fr) minmax(0, 1.1fr);
      gap: 16px;
    }
    @media (max-width: 960px) {
      .layout-main {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* Inputs e bot√µes */
    label {
      display: block;
      font-size: 0.78rem;
      margin-bottom: 3px;
      color: var(--muted);
    }
    input, select, textarea {
      width: 100%;
      padding: 9px 10px;
      border-radius: 11px;
      border: 1px solid var(--border);
      background: #070910;
      color: var(--text);
      font-size: 0.88rem;
      outline: none;
      resize: vertical;
    }
    input:focus, select:focus, textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(76,201,240,0.3);
    }
    .field-row {
      display: grid;
      grid-template-columns: repeat(2,minmax(0,1fr));
      gap: 10px;
    }
    .field-row-3 {
      display: grid;
      grid-template-columns: repeat(3,minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 720px) {
      .field-row, .field-row-3 {
        grid-template-columns: minmax(0,1fr);
      }
    }

    button {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.82rem;
      padding: 9px 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent), #4895ef);
      color: #020308;
      box-shadow: 0 10px 26px rgba(72,149,239,0.5);
    }
    .btn-ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
    }
    .btn-danger {
      background: var(--danger);
      color: #fff;
    }
    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    /* Barra de progresso */
    .progress-wrap {
      margin-top: 6px;
    }
    .progress-label-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.78rem;
      color: var(--muted);
      margin-bottom: 4px;
    }
    .progress-bar {
      position: relative;
      width: 100%;
      height: 12px;
      border-radius: 999px;
      background: #050612;
      border: 1px solid var(--border);
      overflow: hidden;
    }
    .progress-fill {
      position: absolute;
      inset: 0;
      width: 0%;
      background: linear-gradient(90deg, var(--accent2), var(--accent));
      box-shadow: 0 0 20px rgba(247,37,133,0.4);
      transition: width 0.4s ease-out;
    }

    /* Tabelas e gr√°ficos */
    .table-wrap {
      overflow-x: auto;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #05060b;
      -webkit-overflow-scrolling: touch;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      min-width: 640px;
    }
    thead {
      background: linear-gradient(90deg, #111625, #171d33);
    }
    th, td {
      padding: 7px 9px;
      text-align: left;
      white-space: nowrap;
    }
    th {
      font-weight: 600;
      font-size: 0.76rem;
      color: #c4c7de;
      border-bottom: 1px solid var(--border);
    }
    tbody tr:nth-child(even) {
      background: rgba(255,255,255,0.02);
    }
    tbody tr:hover {
      background: rgba(76,201,240,0.06);
    }
    .pill {
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      font-size: 0.7rem;
      color: var(--muted);
    }

    canvas {
      width: 100% !important;
      max-height: 280px !important;
    }

    /* Login */
    .auth-layout {
      display: grid;
      grid-template-columns: minmax(0,1.1fr) minmax(0,1.1fr);
      gap: 18px;
    }
    @media (max-width: 880px) {
      .auth-layout {
        grid-template-columns: minmax(0,1fr);
      }
    }

    /* Mensagens / alertas */
    .alert {
      font-size: 0.8rem;
      border-radius: 12px;
      padding: 8px 10px;
      margin-top: 6px;
    }
    .alert-info {
      background: rgba(76,201,240,0.08);
      border: 1px solid var(--accent-soft);
      color: var(--accent);
    }
    .alert-error {
      background: rgba(255,107,107,0.12);
      border: 1px solid rgba(255,107,107,0.4);
      color: var(--danger);
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }
    .tag-pill {
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-size: 0.7rem;
      color: var(--muted);
      background: rgba(255,255,255,0.02);
    }

    .section-divider {
      margin: 10px 0;
      border-top: 1px dashed rgba(255,255,255,0.08);
    }

    .two-col {
      display: grid;
      grid-template-columns: minmax(0,1fr) minmax(0,1fr);
      gap: 14px;
    }
    @media (max-width: 720px) {
      .two-col {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .small {
      font-size: 0.75rem;
      color: var(--muted);
    }

    /* Esconder telas por estado */
    #app-main {
      display: none;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <!-- Topo / Branding -->
    <div class="brand-row">
      <div>
        <div class="brand-title">Sua evolu√ß√£o come√ßa aqui</div>
        <div class="brand-sub">DARK PREMIUM ‚Ä¢ FITNESS ‚Ä¢ SA√öDE</div>
      </div>
      <div class="tag-row">
        <span class="chip chip-accent">Firebase + GitHub</span>
        <span class="chip">Dom√≠nio: esoares.net.br</span>
      </div>
    </div>

    <!-- =================== TELA DE LOGIN / CADASTRO =================== -->
    <div id="auth-screen" class="card card-soft">
      <div class="card-header">
        <div>
          <h2>Entrar na sua √°rea</h2>
          <p class="muted">
            Cada pessoa tem sua pr√≥pria √°rea, metas e dados. E sim, ningu√©m v√™
            o ‚Äúpeso da realidade‚Äù de ningu√©m. üòÖ
          </p>
        </div>
      </div>

      <div class="auth-layout">
        <!-- Login -->
        <div>
          <h3>J√° tenho conta</h3>
          <form id="login-form">
            <label for="login-email">E-mail</label>
            <input type="email" id="login-email" autocomplete="email" required />

            <label for="login-password" style="margin-top:8px;">Senha</label>
            <input type="password" id="login-password" autocomplete="current-password" required />

            <div class="btn-row">
              <button type="submit" class="btn-primary">Entrar</button>
            </div>
            <div id="login-error" class="alert alert-error" style="display:none;"></div>
          </form>
          <p class="small" style="margin-top:10px;">
            Esqueceu a senha? Voc√™ pode resetar direto pelo painel do Firebase
            mais tarde, se quiser implementar recupera√ß√£o.
          </p>
        </div>

        <!-- Cadastro -->
        <div>
          <h3>Sou novo aqui</h3>
          <form id="signup-form">
            <label for="signup-email">E-mail</label>
            <input type="email" id="signup-email" autocomplete="email" required />

            <label for="signup-password" style="margin-top:8px;">Senha</label>
            <input type="password" id="signup-password" minlength="6" autocomplete="new-password" required />

            <label for="signup-name" style="margin-top:8px;">Como quer ser chamado(a)?</label>
            <input type="text" id="signup-name" placeholder="Ex: √âverton" />

            <div class="btn-row">
              <button type="submit" class="btn-ghost">Criar conta</button>
            </div>
            <div id="signup-error" class="alert alert-error" style="display:none;"></div>
          </form>
          <p class="small" style="margin-top:10px;">
            Depois do cadastro voc√™ configura altura, peso inicial, meta e objetivo.
            O resto deixa com o painel. üòâ
          </p>
        </div>
      </div>
    </div>

    <!-- =================== APP PRINCIPAL =================== -->
    <div id="app-main">
      <!-- Barra superior logado -->
      <div class="card card-soft">
        <div class="card-header">
          <div>
            <h2 id="welcome-title">Ol√° üëã</h2>
            <p class="muted" id="welcome-sub">
              Pronto(a) para mais um passo hoje?
            </p>
          </div>
          <div style="text-align:right;">
            <div class="muted" id="current-email"></div>
            <div class="btn-row" style="justify-content:flex-end;margin-top:4px;">
              <button id="btn-open-profile" class="btn-ghost">Perfil & Metas</button>
              <button id="btn-logout" class="btn-danger">Sair</button>
            </div>
          </div>
        </div>

        <!-- Barra de progresso -->
        <div class="progress-wrap">
          <div class="progress-label-row">
            <span>Progresso em rela√ß√£o √† meta</span>
            <span id="progress-label">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
          <p class="small" id="motivation-text" style="margin-top:6px;">
            Assim que voc√™ cadastrar peso inicial, meta e pelo menos um registro,
            a m√°gica come√ßa aqui. ‚ú®
          </p>
        </div>
      </div>

      <!-- Layout principal: esquerda (dados), direita (insights) -->
      <div class="layout-main">
        <!-- COLUNA ESQUERDA: perfil + registros + tabela -->
        <div>
          <!-- Perfil & Metas -->
          <div class="card">
            <div class="card-header">
              <div>
                <h2>Perfil & Metas</h2>
                <p class="muted">
                  Ajuste seus dados iniciais, objetivo e plano alimentar.
                </p>
              </div>
            </div>

            <form id="profile-form">
              <div class="field-row">
                <div>
                  <label for="profile-name">Nome</label>
                  <input id="profile-name" type="text" placeholder="Seu nome" />
                </div>
                <div>
                  <label for="profile-gender">Sexo</label>
                  <select id="profile-gender">
                    <option value="">Selecione...</option>
                    <option value="masculino">Masculino</option>
                    <option value="feminino">Feminino</option>
                    <option value="outro">Outro / Prefiro n√£o dizer</option>
                  </select>
                </div>
              </div>

              <div class="field-row">
                <div>
                  <label for="profile-height">Altura (m)</label>
                  <input id="profile-height" type="number" step="0.01" placeholder="Ex: 1.78" />
                </div>
                <div>
                  <label for="profile-start-weight">Peso inicial (kg)</label>
                  <input id="profile-start-weight" type="number" step="0.1" placeholder="Ex: 92.5" />
                </div>
              </div>

              <div class="field-row">
                <div>
                  <label for="profile-goal-weight">Meta de peso (kg)</label>
                  <input id="profile-goal-weight" type="number" step="0.1" placeholder="Ex: 75" />
                </div>
                <div>
                  <label for="profile-goal-date">Prazo (opcional)</label>
                  <input id="profile-goal-date" type="date" />
                </div>
              </div>

              <div class="field-row">
                <div>
                  <label for="profile-objective">Objetivo principal</label>
                  <select id="profile-objective">
                    <option value="">Selecione...</option>
                    <option value="emagrecimento">Emagrecimento</option>
                    <option value="hipertrofia">Hipertrofia</option>
                    <option value="recomposicao">Recomposi√ß√£o / Sa√∫de geral</option>
                    <option value="performance">Performance (corrida, esportes, etc.)</option>
                  </select>
                </div>
                <div>
                  <label for="profile-diet">Plano alimentar</label>
                  <select id="profile-diet">
                    <option value="">Selecione...</option>
                    <option value="lowcarb">Low carb</option>
                    <option value="hipertrofia">Alta prote√≠na / hipertrofia</option>
                    <option value="mediterranea">Mediterr√¢nea</option>
                    <option value="flexivel">Flex√≠vel / IIFYM</option>
                  </select>
                </div>
              </div>

              <div class="btn-row">
                <button type="submit" class="btn-primary">Salvar perfil</button>
              </div>
              <div id="profile-msg" class="alert alert-info" style="display:none;"></div>
            </form>

            <div class="section-divider"></div>

            <!-- Alterar senha (simples) -->
            <h3>Seguran√ßa</h3>
            <p class="small">
              Quer trocar a senha? Use o campo abaixo. (Caso o Firebase pe√ßa
              ‚Äúlogin recente‚Äù, √© s√≥ sair e entrar de novo antes de tentar).
            </p>
            <form id="password-form" style="margin-top:6px;">
              <label for="new-password">Nova senha</label>
              <input id="new-password" type="password" minlength="6" />
              <div class="btn-row">
                <button type="submit" class="btn-ghost">Atualizar senha</button>
              </div>
              <div id="password-msg" class="alert alert-info" style="display:none;"></div>
            </form>
          </div>

          <!-- Registro semanal -->
          <div class="card">
            <div class="card-header">
              <div>
                <h2>Registro semanal</h2>
                <p class="muted">
                  Quanto mais honesto voc√™ for aqui, mais bonito o gr√°fico
                  (e a sa√∫de) ficam. üòé
                </p>
              </div>
            </div>

            <form id="entry-form">
              <div class="field-row">
                <div>
                  <label for="entry-date">Data da semana</label>
                  <input id="entry-date" type="date" required />
                </div>
                <div>
                  <label for="entry-label">Nome da semana (opcional)</label>
                  <input id="entry-label" type="text" placeholder="Ex: Semana 1, Semana 2..." />
                </div>
              </div>

              <div class="field-row-3" style="margin-top:8px;">
                <div>
                  <label for="entry-weight">Peso (kg)</label>
                  <input id="entry-weight" type="number" step="0.1" required />
                </div>
                <div>
                  <label for="entry-waist">Cintura (cm)</label>
                  <input id="entry-waist" type="number" step="0.1" />
                </div>
                <div>
                  <label for="entry-energy">Energia (1‚Äì10)</label>
                  <input id="entry-energy" type="number" min="1" max="10" />
                </div>
              </div>

              <div class="field-row-3" style="margin-top:8px;">
                <div>
                  <label for="entry-mood">Humor (1‚Äì10)</label>
                  <input id="entry-mood" type="number" min="1" max="10" />
                </div>
                <div>
                  <label for="entry-sleep">Sono (1‚Äì10)</label>
                  <input id="entry-sleep" type="number" min="1" max="10" />
                </div>
                <div>
                  <label for="entry-notes">Observa√ß√µes</label>
                  <input id="entry-notes" type="text" placeholder="Ex: +cardio, menos fome, viagem..." />
                </div>
              </div>

              <div class="btn-row">
                <button type="submit" class="btn-primary">Ôºã Registrar / atualizar semana</button>
              </div>
              <div id="entry-msg" class="alert alert-info" style="display:none;"></div>
            </form>
          </div>

          <!-- Hist√≥rico -->
          <div class="card">
            <div class="card-header">
              <div>
                <h2>Hist√≥rico & IMC</h2>
                <p class="muted">
                  Peso, cintura, IMC e sensa√ß√£o geral por semana.
                </p>
              </div>
            </div>
            <div class="table-wrap">
              <table id="history-table">
                <thead>
                  <tr>
                    <th>Semana</th>
                    <th>Data</th>
                    <th>Peso (kg)</th>
                    <th>IMC</th>
                    <th>Cintura (cm)</th>
                    <th>Energia</th>
                    <th>Humor</th>
                    <th>Sono</th>
                    <th>Obs.</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- preenchido via JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- COLUNA DIREITA: dashboards + dicas -->
        <div>
          <!-- Gr√°fico peso + IMC -->
          <div class="card card-soft">
            <div class="card-header">
              <div>
                <h2>Dashboard Peso + IMC</h2>
                <p class="muted">
                  Duas linhas, uma verdade: voc√™ est√° indo pra onde quer?
                </p>
              </div>
            </div>
            <canvas id="chart-weight-bmi"></canvas>
            <p class="small" style="margin-top:6px;" id="bmi-summary">
              Assim que voc√™ registrar alguns dados, aparece um resumo do IMC aqui.
            </p>
          </div>

          <!-- Dicas de treino + v√≠deos -->
          <div class="card">
            <div class="card-header">
              <div>
                <h2>Treinos recomendados</h2>
                <p class="muted">
                  Ajustados ao objetivo e sexo informados. Sempre respeite
                  orienta√ß√µes do(a) profissional de sa√∫de.
                </p>
              </div>
            </div>

            <div id="workout-content" class="small">
              <!-- preenchido via JS -->
            </div>

            <div class="section-divider"></div>

            <h3>V√≠deos de execu√ß√£o (YouTube)</h3>
            <p class="small">
              Alguns exemplos para conferir t√©cnica (abra em nova aba):
            </p>
            <ul class="small">
              <li><a href="https://www.youtube.com/results?search_query=agachamento+livre+execu%C3%A7%C3%A3o+correta" target="_blank">Agachamento livre ‚Äì execu√ß√£o correta</a></li>
              <li><a href="https://www.youtube.com/results?search_query=supino+reto+execu%C3%A7%C3%A3o+correta" target="_blank">Supino reto ‚Äì execu√ß√£o correta</a></li>
              <li><a href="https://www.youtube.com/results?search_query=remada+curvada+execu%C3%A7%C3%A3o+correta" target="_blank">Remada curvada ‚Äì execu√ß√£o correta</a></li>
              <li><a href="https://www.youtube.com/results?search_query=prancha+abdominal+execu%C3%A7%C3%A3o+correta" target="_blank">Prancha abdominal ‚Äì execu√ß√£o correta</a></li>
            </ul>
          </div>

          <!-- Dieta, suplementos e IA de bolso -->
          <div class="card card-soft">
            <div class="card-header">
              <div>
                <h2>Nutri√ß√£o & Suplementos</h2>
                <p class="muted">
                  Sugest√µes r√°pidas de dieta + espa√ßo para voc√™ registrar o que usa.
                </p>
              </div>
            </div>

            <div class="two-col">
              <div>
                <h3>Dieta selecionada</h3>
                <div id="diet-content" class="small">
                  <!-- preenchido via JS -->
                </div>
              </div>
              <div>
                <h3>Suplementos & hor√°rios</h3>
                <form id="supp-form">
                  <label for="supp-notes">O que voc√™ est√° tomando?</label>
                  <textarea id="supp-notes" rows="3" placeholder="Ex: Whey, creatina, multivitam√≠nico, vitamina D..."></textarea>
                  <div class="btn-row" style="margin-top:8px;">
                    <button type="submit" class="btn-ghost">Gerar sugest√£o de hor√°rios</button>
                  </div>
                </form>
                <div id="supp-suggestion" class="small" style="margin-top:6px;">
                  Digite seus suplementos e eu te devolvo uma sugest√£o geral de hor√°rios.
                </div>
              </div>
            </div>
          </div>
        </div> <!-- fim coluna direita -->
      </div> <!-- fim layout-main -->
    </div> <!-- fim app-main -->
  </div>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Firebase (vers√£o modular) -->
  <script type="module">
    // IMPORTS FIREBASE (modular v10.x)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      updateProfile,
      updatePassword
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import {
      getFirestore,
      doc,
      setDoc,
      getDoc,
      collection,
      addDoc,
      getDocs,
      query,
      orderBy,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // ======== CONFIG DO SEU PROJETO FIREBASE =========
    const firebaseConfig = {
      apiKey: "AIzaSyBbz-DjxSv2S2g1qkWca8YpNn3g7C4Oic0",
      authDomain: "evolucao-dark-premium.firebaseapp.com",
      projectId: "evolucao-dark-premium",
      storageBucket: "evolucao-dark-premium.firebasestorage.app",
      messagingSenderId: "1041789751060",
      appId: "1:1041789751060:web:eb2afd0d1a4af526e0fc01"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // ======== ELEMENTOS DE TELA =========
    const authScreen = document.getElementById("auth-screen");
    const appMain   = document.getElementById("app-main");

    const loginForm     = document.getElementById("login-form");
    const signupForm    = document.getElementById("signup-form");
    const loginErrorEl  = document.getElementById("login-error");
    const signupErrorEl = document.getElementById("signup-error");

    const welcomeTitle = document.getElementById("welcome-title");
    const welcomeSub   = document.getElementById("welcome-sub");
    const currentEmailEl = document.getElementById("current-email");
    const btnLogout      = document.getElementById("btn-logout");
    const btnOpenProfile = document.getElementById("btn-open-profile");

    const progressFill  = document.getElementById("progress-fill");
    const progressLabel = document.getElementById("progress-label");
    const motivationText = document.getElementById("motivation-text");

    const profileForm = document.getElementById("profile-form");
    const profileMsg  = document.getElementById("profile-msg");

    const passwordForm = document.getElementById("password-form");
    const passwordMsg  = document.getElementById("password-msg");

    const entryForm = document.getElementById("entry-form");
    const entryMsg  = document.getElementById("entry-msg");
    const historyTableBody = document.querySelector("#history-table tbody");

    const bmiSummaryEl = document.getElementById("bmi-summary");
    const workoutContent = document.getElementById("workout-content");
    const dietContent = document.getElementById("diet-content");
    const suppForm = document.getElementById("supp-form");
    const suppNotes = document.getElementById("supp-notes");
    const suppSuggestion = document.getElementById("supp-suggestion");

    // Campos de perfil
    const profileNameEl = document.getElementById("profile-name");
    const profileGenderEl = document.getElementById("profile-gender");
    const profileHeightEl = document.getElementById("profile-height");
    const profileStartWeightEl = document.getElementById("profile-start-weight");
    const profileGoalWeightEl = document.getElementById("profile-goal-weight");
    const profileGoalDateEl = document.getElementById("profile-goal-date");
    const profileObjectiveEl = document.getElementById("profile-objective");
    const profileDietEl = document.getElementById("profile-diet");

    // Campos registro semanal
    const entryDateEl    = document.getElementById("entry-date");
    const entryLabelEl   = document.getElementById("entry-label");
    const entryWeightEl  = document.getElementById("entry-weight");
    const entryWaistEl   = document.getElementById("entry-waist");
    const entryEnergyEl  = document.getElementById("entry-energy");
    const entryMoodEl    = document.getElementById("entry-mood");
    const entrySleepEl   = document.getElementById("entry-sleep");
    const entryNotesEl   = document.getElementById("entry-notes");

    const newPasswordEl  = document.getElementById("new-password");

    let chartWeightBmi = null;
    let currentProfile = null;
    let currentEntries = [];

    // ========= AUTENTICA√á√ÉO ==========
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        authScreen.style.display = "none";
        appMain.style.display = "block";
        currentEmailEl.textContent = user.email || "";

        welcomeTitle.textContent = user.displayName
          ? `Ol√°, ${user.displayName} üëã`
          : "Ol√° üëã";

        await loadProfileAndEntries(user.uid);
      } else {
        appMain.style.display = "none";
        authScreen.style.display = "block";
      }
    });

    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      loginErrorEl.style.display = "none";
      try {
        const email = document.getElementById("login-email").value.trim();
        const password = document.getElementById("login-password").value;
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        console.error(err);
        loginErrorEl.textContent = "Erro ao entrar: " + (err.message || err.code);
        loginErrorEl.style.display = "block";
      }
    });

    signupForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      signupErrorEl.style.display = "none";
      try {
        const email = document.getElementById("signup-email").value.trim();
        const password = document.getElementById("signup-password").value;
        const name = document.getElementById("signup-name").value.trim();

        const cred = await createUserWithEmailAndPassword(auth, email, password);
        if (name) {
          await updateProfile(cred.user, { displayName: name });
        }
      } catch (err) {
        console.error(err);
        signupErrorEl.textContent = "Erro ao criar conta: " + (err.message || err.code);
        signupErrorEl.style.display = "block";
      }
    });

    btnLogout.addEventListener("click", async () => {
      await signOut(auth);
    });

    btnOpenProfile.addEventListener("click", () => {
      // S√≥ rola at√© o card de perfil/metas
      document.querySelector("#profile-form").scrollIntoView({ behavior: "smooth", block: "start" });
    });

    // ========= CARREGAR PERFIL + REGISTROS ==========
    async function loadProfileAndEntries(uid) {
      try {
        // Perfil
        const userRef = doc(db, "users", uid);
        const snap = await getDoc(userRef);
        if (snap.exists()) {
          currentProfile = snap.data();
        } else {
          currentProfile = {};
        }
        fillProfileForm(currentProfile);

        // Entradas
        const entriesRef = collection(db, "users", uid, "entries");
        const q = query(entriesRef, orderBy("date", "asc"));
        const qSnap = await getDocs(q);
        currentEntries = [];
        qSnap.forEach(docSnap => {
          currentEntries.push({
            id: docSnap.id,
            ...docSnap.data()
          });
        });

        renderHistoryTable();
        renderChartsAndProgress();
        renderWorkoutSuggestions();
        renderDietSuggestions();
      } catch (err) {
        console.error("Erro ao carregar dados:", err);
      }
    }

    function fillProfileForm(profile) {
      profileNameEl.value = profile.name || "";
      profileGenderEl.value = profile.gender || "";
      profileHeightEl.value = profile.height || "";
      profileStartWeightEl.value = profile.startWeight || "";
      profileGoalWeightEl.value  = profile.goalWeight || "";
      profileGoalDateEl.value    = profile.goalDate || "";
      profileObjectiveEl.value   = profile.objective || "";
      profileDietEl.value        = profile.diet || "";
    }

    // ========= SALVAR PERFIL ==========
    profileForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return;

      const data = {
        name: profileNameEl.value.trim() || null,
        gender: profileGenderEl.value || null,
        height: profileHeightEl.value ? parseFloat(profileHeightEl.value.replace(",", ".")) : null,
        startWeight: profileStartWeightEl.value ? parseFloat(profileStartWeightEl.value.replace(",", ".")) : null,
        goalWeight: profileGoalWeightEl.value ? parseFloat(profileGoalWeightEl.value.replace(",", ".")) : null,
        goalDate: profileGoalDateEl.value || null,
        objective: profileObjectiveEl.value || null,
        diet: profileDietEl.value || null,
        updatedAt: serverTimestamp()
      };

      try {
        // Atualiza displayName tamb√©m
        if (data.name) {
          await updateProfile(user, { displayName: data.name });
        }
        await setDoc(doc(db, "users", user.uid), data, { merge: true });
        profileMsg.textContent = "Perfil salvo com sucesso.";
        profileMsg.style.display = "block";
        setTimeout(() => profileMsg.style.display = "none", 3000);
        await loadProfileAndEntries(user.uid);
      } catch (err) {
        console.error(err);
        profileMsg.textContent = "Erro ao salvar perfil: " + (err.message || err.code);
        profileMsg.style.display = "block";
      }
    });

    // ========= TROCAR SENHA ==========
    passwordForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return;
      const newPass = newPasswordEl.value;
      if (!newPass || newPass.length < 6) {
        passwordMsg.textContent = "A senha precisa ter pelo menos 6 caracteres.";
        passwordMsg.style.display = "block";
        return;
      }
      try {
        await updatePassword(user, newPass);
        passwordMsg.textContent = "Senha atualizada com sucesso.";
        passwordMsg.style.display = "block";
        newPasswordEl.value = "";
        setTimeout(() => passwordMsg.style.display = "none", 3000);
      } catch (err) {
        console.error(err);
        passwordMsg.textContent = "Erro ao atualizar senha: " + (err.message || err.code);
        passwordMsg.style.display = "block";
      }
    });

    // ========= REGISTRO SEMANAL ==========
    entryForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return;

      const date = entryDateEl.value;
      const label = entryLabelEl.value.trim();
      const weight = parseFloat((entryWeightEl.value || "").replace(",", "."));
      const waist  = entryWaistEl.value ? parseFloat(entryWaistEl.value.replace(",", ".")) : null;
      const energy = entryEnergyEl.value ? parseInt(entryEnergyEl.value, 10) : null;
      const mood   = entryMoodEl.value ? parseInt(entryMoodEl.value, 10) : null;
      const sleep  = entrySleepEl.value ? parseInt(entrySleepEl.value, 10) : null;
      const notes  = entryNotesEl.value.trim() || null;

      if (!date || isNaN(weight)) {
        entryMsg.textContent = "Informe pelo menos data e peso.";
        entryMsg.style.display = "block";
        return;
      }

      let bmi = null;
      const h = profileHeightEl.value ? parseFloat(profileHeightEl.value.replace(",", ".")) : (currentProfile?.height || null);
      if (h && !isNaN(h) && h > 0) {
        bmi = +(weight / (h * h)).toFixed(1);
      }

      try {
        // se j√° existir entrada nessa data, sobrescreve
        const existing = currentEntries.find(e => e.date === date);
        const payload = {
          date,
          label: label || null,
          weight,
          waist,
          energy,
          mood,
          sleep,
          notes,
          bmi,
          updatedAt: serverTimestamp()
        };

        const entriesRef = collection(db, "users", user.uid, "entries");
        if (existing) {
          // atualiza doc existente
          await setDoc(doc(entriesRef, existing.id), payload, { merge: true });
        } else {
          await addDoc(entriesRef, {
            ...payload,
            createdAt: serverTimestamp()
          });
        }

        entryMsg.textContent = "Semana registrada com sucesso.";
        entryMsg.style.display = "block";
        setTimeout(() => entryMsg.style.display = "none", 3000);

        // limpa campos mais ‚Äúsens√≠veis‚Äù
        entryNotesEl.value = "";
        entryLabelEl.value = "";

        await loadProfileAndEntries(user.uid);
      } catch (err) {
        console.error(err);
        entryMsg.textContent = "Erro ao salvar registro: " + (err.message || err.code);
        entryMsg.style.display = "block";
      }
    });

    // ========= HIST√ìRICO TABELA ==========
    function renderHistoryTable() {
      historyTableBody.innerHTML = "";
      if (!currentEntries || currentEntries.length === 0) return;

      currentEntries.forEach(entry => {
        const tr = document.createElement("tr");
        const label = entry.label || "";
        const weekLabel = label ? label : "‚Äì";
        const dateStr = entry.date || "";
        const bmiStr = entry.bmi != null ? entry.bmi.toFixed(1) : "";

        tr.innerHTML = `
          <td><span class="pill">${weekLabel}</span></td>
          <td>${dateStr}</td>
          <td>${entry.weight ?? ""}</td>
          <td>${bmiStr}</td>
          <td>${entry.waist ?? ""}</td>
          <td>${entry.energy ?? ""}</td>
          <td>${entry.mood ?? ""}</td>
          <td>${entry.sleep ?? ""}</td>
          <td>${entry.notes ?? ""}</td>
        `;
        historyTableBody.appendChild(tr);
      });
    }

    // ========= GR√ÅFICOS + PROGRESSO ==========
    function renderChartsAndProgress() {
      // progresso / barra
      const startWeight = currentProfile?.startWeight;
      const goalWeight  = currentProfile?.goalWeight;
      let latestWeight = null;
      if (currentEntries.length > 0) {
        latestWeight = currentEntries[currentEntries.length - 1].weight;
      }

      let pct = 0;
      if (startWeight && goalWeight && latestWeight) {
        const start = startWeight;
        const goal = goalWeight;
        const current = latestWeight;

        if (start > goal) {
          // emagrecimento
          const total = start - goal;
          const done  = start - current;
          pct = Math.max(0, Math.min(1, done / total));
        } else if (goal > start) {
          // ganho de peso
          const total = goal - start;
          const done  = current - start;
          pct = Math.max(0, Math.min(1, done / total));
        }
      }

      const pctDisplay = Math.round(pct * 100);
      progressFill.style.width = pctDisplay + "%";
      progressLabel.textContent = pctDisplay + "%";

      // mensagem motivacional
      let msg;
      if (!startWeight || !goalWeight || !latestWeight) {
        msg = "Defina peso inicial, meta e registre pelo menos uma semana para liberar o modo turbo de motiva√ß√£o. üöÄ";
      } else if (pctDisplay <= 0) {
        msg = "Oficialmente come√ßando do zero. Nada mais perigoso que algu√©m decidido a sair do 0%. üòâ";
      } else if (pctDisplay < 25) {
        msg = `Voc√™ j√° saiu da in√©rcia (${pctDisplay}%). A parte mais dif√≠cil j√° foi: come√ßar. Continua que o gr√°fico vai ficando bonito.`;
      } else if (pctDisplay < 60) {
        msg = `${pctDisplay}% completos. Voc√™ est√° naquela fase em que as pessoas come√ßam a perguntar: ‚Äúo que voc√™ est√° fazendo?‚Äù üòè`;
      } else if (pctDisplay < 90) {
        msg = `${pctDisplay}%! J√° d√° pra considerar ‚Äúmodo quase final boss‚Äù. S√≥ n√£o para agora, que a reta final √© trai√ßoeira.`;
      } else {
        msg = `${pctDisplay}% da meta. √â praticamente outra pessoa j√°. S√≥ falta o ‚Äúfechar com chave de ouro‚Äù. üîí‚ú®`;
      }
      motivationText.textContent = msg;

      // gr√°fico peso + IMC
      const ctx = document.getElementById("chart-weight-bmi").getContext("2d");
      if (chartWeightBmi) {
        chartWeightBmi.destroy();
      }

      if (!currentEntries || currentEntries.length === 0) {
        bmiSummaryEl.textContent = "Sem dados suficientes ainda. Registre pelo menos uma semana para ver o gr√°fico.";
        return;
      }

      const labels = currentEntries.map(e => e.label || e.date || "");
      const weights = currentEntries.map(e => e.weight || null);
      const bmis    = currentEntries.map(e => e.bmi || null);

      chartWeightBmi = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [
            {
              label: "Peso (kg)",
              data: weights,
              borderColor: "#4cc9f0",
              backgroundColor: "rgba(76,201,240,0.14)",
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 3
            },
            {
              label: "IMC",
              data: bmis,
              borderColor: "#f72585",
              backgroundColor: "rgba(247,37,133,0.16)",
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: { color: "#d0d3ea", usePointStyle: true }
            }
          },
          scales: {
            x: {
              ticks: { color: "#9ba0c2" },
              grid: { color: "rgba(255,255,255,0.03)" }
            },
            y: {
              ticks: { color: "#9ba0c2" },
              grid: { color: "rgba(255,255,255,0.03)" }
            }
          }
        }
      });

      // resumo de IMC mais recente
      const last = currentEntries[currentEntries.length - 1];
      if (last && last.bmi) {
        const bmi = last.bmi;
        let cat = "";
        if (bmi < 18.5) cat = "Abaixo do peso";
        else if (bmi < 25) cat = "Peso adequado";
        else if (bmi < 30) cat = "Sobrepeso";
        else cat = "Obesidade";
        bmiSummaryEl.textContent = `IMC atual aproximado: ${bmi.toFixed(1)} (${cat}). Lembre: IMC √© s√≥ um indicador, n√£o define sua hist√≥ria. üòâ`;
      } else {
        bmiSummaryEl.textContent = "Ainda n√£o foi poss√≠vel calcular o IMC. Confira se a altura e o peso est√£o preenchidos.";
      }
    }

    // ========= TREINOS (por objetivo + sexo) ==========
    function renderWorkoutSuggestions() {
      const obj = currentProfile?.objective || "";
      const gender = currentProfile?.gender || "";
      let titleExtra = "";
      if (gender === "feminino") {
        titleExtra = " com foco extra em gl√∫teos, pernas e postura, se desejar.";
      } else if (gender === "masculino") {
        titleExtra = " com foco cl√°ssico em for√ßa, peitoral e costas ‚Äì sem esquecer perna, hein. üòâ";
      } else {
        titleExtra = " focado em sa√∫de, for√ßa e est√©tica de forma geral.";
      }

      let html = `<p class="small">Planejamento sugerido considerando seu objetivo selecionado${titleExtra}</p>`;

      if (obj === "emagrecimento" || obj === "") {
        html += `
          <h3>Fase base ‚Äì Emagrecimento saud√°vel</h3>
          <ul>
            <li><strong>Muscula√ß√£o: 3‚Äì4x/semana</strong>
              <ul>
                <li>Agachamento livre ou leg press ‚Äì 3x10‚Äì12</li>
                <li>Supino reto ou m√°quina ‚Äì 3x10‚Äì12</li>
                <li>Remada baixa ou curvada ‚Äì 3x10‚Äì12</li>
                <li>Desenvolvimento de ombro ‚Äì 3x10‚Äì12</li>
                <li>Prancha abdominal ‚Äì 3x30‚Äì40s</li>
              </ul>
            </li>
            <li><strong>Cardio leve: 4‚Äì6x/semana</strong> ‚Äì caminhadas r√°pidas de 20‚Äì30 minutos.</li>
            <li><strong>Dica:</strong> se estiver muito pesado, comece com 10‚Äì15 min de caminhada e v√° subindo.</li>
          </ul>
        `;
      } else if (obj === "hipertrofia") {
        html += `
          <h3>Fase base ‚Äì Hipertrofia</h3>
          <ul>
            <li><strong>Muscula√ß√£o: 4‚Äì5x/semana</strong>
              <ul>
                <li>Dia 1: Peito + tr√≠ceps ‚Äì 3‚Äì4 exerc√≠cios, 3x8‚Äì10</li>
                <li>Dia 2: Costas + b√≠ceps ‚Äì 3‚Äì4 exerc√≠cios, 3x8‚Äì10</li>
                <li>Dia 3: Pernas + gl√∫teo ‚Äì 4‚Äì5 exerc√≠cios, 3x8‚Äì12</li>
                <li>Dia 4: Ombro + abd√¥men ‚Äì 3‚Äì4 exerc√≠cios, 3x10‚Äì12</li>
              </ul>
            </li>
            <li><strong>Cardio leve: 2‚Äì3x/semana</strong> ‚Äì 15‚Äì20 min s√≥ pra sa√∫de, n√£o pra se matar.</li>
          </ul>
        `;
      } else if (obj === "performance") {
        html += `
          <h3>Fase base ‚Äì Performance</h3>
          <ul>
            <li><strong>Muscula√ß√£o: 2‚Äì3x/semana</strong> ‚Äì foco em for√ßa geral (agachamento, terra, supino, remada).</li>
            <li><strong>Treino espec√≠fico: 3‚Äì4x/semana</strong> ‚Äì corrida, bike, esporte que voc√™ pratica.</li>
            <li><strong>Cardio intervalado</strong> 1‚Äì2x/semana, se j√° tiver base de condicionamento.</li>
          </ul>
        `;
      } else if (obj === "recomposicao") {
        html += `
          <h3>Fase base ‚Äì Recomposi√ß√£o corporal</h3>
          <ul>
            <li><strong>Muscula√ß√£o: 3‚Äì4x/semana</strong> ‚Äì alternando parte superior e inferior.</li>
            <li><strong>Cardio moderado: 3x/semana</strong> ‚Äì 20‚Äì30 min.</li>
          </ul>
        `;
      }

      html += `
        <p class="small">
          Lembre: s√©ries, repeti√ß√µes e exerc√≠cios podem (e devem) ser ajustados por um(a) profissional de educa√ß√£o f√≠sica
          de acordo com suas limita√ß√µes e hist√≥rico.
        </p>
      `;

      workoutContent.innerHTML = html;
    }

    // ========= DIETA (por plano) ==========
    function renderDietSuggestions() {
      const diet = currentProfile?.diet || "";
      let html = "";

      if (!diet) {
        html = `
          <p class="small">
            Selecione um plano alimentar em ‚ÄúPerfil & Metas‚Äù para ver aqui
            uma sugest√£o b√°sica de alimentos recomendados, evitar e um exemplo de dia.
          </p>
        `;
        dietContent.innerHTML = html;
        return;
      }

      if (diet === "lowcarb") {
        html += `
          <p><strong>Low carb ‚Äì foco em controle de carboidratos</strong></p>
          <div class="tag-row">
            <span class="tag-pill">Prote√≠na em todas as refei√ß√µes</span>
            <span class="tag-pill">Carbo de qualidade</span>
            <span class="tag-pill">Muita salada</span>
          </div>
          <p class="small"><strong>Recomendados:</strong> ovos, carnes magras, peixe, frango, queijos magros, azeite, abacate, castanhas, saladas, legumes, frutas com menos a√ß√∫car (morango, kiwi, frutas vermelhas).</p>
          <p class="small"><strong>Evitar:</strong> a√ß√∫car, refrigerante, p√£es brancos, massas, doces, ultraprocessados em geral.</p>
          <p class="small"><strong>Exemplo de dia:</strong><br/>
            ‚Ä¢ Caf√© da manh√£: omelete com queijo + caf√© sem a√ß√∫car<br/>
            ‚Ä¢ Almo√ßo: frango grelhado + salada grande + legumes refogados<br/>
            ‚Ä¢ Lanche: iogurte natural + castanhas<br/>
            ‚Ä¢ Jantar: peixe assado + salada + legumes
          </p>
        `;
      } else if (diet === "hipertrofia") {
        html += `
          <p><strong>Dieta para hipertrofia ‚Äì alta prote√≠na</strong></p>
          <div class="tag-row">
            <span class="tag-pill">Prote√≠na 1,6‚Äì2,2 g/kg</span>
            <span class="tag-pill">Carbo em torno do treino</span>
            <span class="tag-pill">Gorduras boas</span>
          </div>
          <p class="small"><strong>Recomendados:</strong> arroz, batata-doce, aveia, frango, carne magra, ovos, feij√£o, lentilha, frutas, azeite, pasta de amendoim.</p>
          <p class="small"><strong>Evitar excesso de:</strong> frituras, √°lcool, fast-food, doces em excesso.</p>
          <p class="small"><strong>Exemplo de dia:</strong><br/>
            ‚Ä¢ Caf√©: ovos mexidos + p√£o integral + fruta<br/>
            ‚Ä¢ Almo√ßo: arroz + feij√£o + carne magra + salada<br/>
            ‚Ä¢ Pr√©-treino: banana + aveia + whey (se usar)<br/>
            ‚Ä¢ P√≥s-treino: refei√ß√£o com boa prote√≠na + carbo de qualidade<br/>
            ‚Ä¢ Jantar: fonte de prote√≠na + legumes + um pouco de carbo
          </p>
        `;
      } else if (diet === "mediterranea") {
        html += `
          <p><strong>Dieta mediterr√¢nea ‚Äì sa√∫de geral</strong></p>
          <div class="tag-row">
            <span class="tag-pill">Muito vegetal</span>
            <span class="tag-pill">Azeite de oliva</span>
            <span class="tag-pill">Peixes e gr√£os</span>
          </div>
          <p class="small"><strong>Recomendados:</strong> peixes, azeite, frutas, legumes, gr√£os integrais, nozes, castanhas.</p>
          <p class="small"><strong>Evitar excesso de:</strong> ultraprocessados, carnes muito gordas, a√ß√∫car.</p>
        `;
      } else if (diet === "flexivel") {
        html += `
          <p><strong>Dieta flex√≠vel ‚Äì IIFYM</strong></p>
          <div class="tag-row">
            <span class="tag-pill">Conta macros</span>
            <span class="tag-pill">80% comida ‚Äúde verdade‚Äù</span>
            <span class="tag-pill">20% flex√≠vel</span>
          </div>
          <p class="small">
            Ideia: bater prote√≠na, carbo e gordura di√°rios, com maioria das calorias vindas de comida boa,
            permitindo pequenas flexibiliza√ß√µes (pizza, doce, etc.) de forma planejada.
          </p>
        `;
      }

      html += `
        <p class="small">
          Essas s√£o apenas linhas gerais. Nutricionista √© sempre o(a) melhor amigo(a)
          para personalizar tudo de acordo com exames, hist√≥rico e prefer√™ncias.
        </p>
      `;

      dietContent.innerHTML = html;
    }

    // ========= ‚ÄúIA‚Äù de suplementos (regras simples) ==========
    suppForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const text = (suppNotes.value || "").toLowerCase();
      if (!text.trim()) {
        suppSuggestion.textContent = "Escreva pelo menos um suplemento para eu poder te sugerir hor√°rios gerais.";
        return;
      }

      let parts = [];
      if (text.includes("whey")) {
        parts.push("‚Ä¢ Whey: geralmente p√≥s-treino ou como lanche proteico entre refei√ß√µes.");
      }
      if (text.includes("creatina")) {
        parts.push("‚Ä¢ Creatina: 3‚Äì5 g por dia, hor√°rio flex√≠vel (junto de alguma refei√ß√£o). Consist√™ncia √© mais importante que hor√°rio.");
      }
      if (text.includes("vitamina d")) {
        parts.push("‚Ä¢ Vitamina D: normalmente 1x ao dia, com refei√ß√£o que tenha alguma gordura (melhora absor√ß√£o).");
      }
      if (text.includes("multivit") || text.includes("multivitam")) {
        parts.push("‚Ä¢ Multivitam√≠nico: junto de uma refei√ß√£o principal (caf√©, almo√ßo ou jantar).");
      }
      if (text.includes("cafeina") || text.includes("cafe√≠na") || text.includes("pr√©-treino") || text.includes("pre-treino")) {
        parts.push("‚Ä¢ Cafe√≠na / pr√©-treino: 30‚Äì45 min antes do treino (evitar muito tarde para n√£o atrapalhar o sono).");
      }

      if (parts.length === 0) {
        parts.push("N√£o encontrei suplementos espec√≠ficos no texto, ent√£o a sugest√£o geral √©: distribua vitaminas junto das refei√ß√µes principais, creatina em qualquer hor√°rio do dia e estimulantes (cafe√≠na) longe da hora de dormir.");
      }

      suppSuggestion.innerHTML = `
        <p class="small"><strong>Sugest√£o geral de hor√°rios:</strong></p>
        <p class="small">${parts.join("<br/>")}</p>
        <p class="small">Sempre siga as orienta√ß√µes do(a) m√©dico(a) / nutricionista. Aqui √© s√≥ um guia geral.</p>
      `;
    });
  </script>
</body>
</html>
